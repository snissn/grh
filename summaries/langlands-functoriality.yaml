a2a_doc:
  1_meta:
    title_long: "Langlands Functoriality via Fixed–Heat Positivity and GRH — Completion paper linked to the GRH suite (Parts I–III) (src: sec:intro)"
    title_short: "Functoriality via Fixed–Heat Positivity"
    authors: ["Michael Seiler"]
    venue: "preprint (unrefereed)"
    year: 2025
    version: "preprint (2025-09-01)"
    url: "Langlands-Functoriality.pdf"
    dependencies:
      summary: "Relies on GRH Trilogy infrastructure: A1–A5, R*, and the Part II ν‑projector."
      requires: ["A1","A2","A3","A4","A5","R*","ν‑proj"]
      upstream_sources: ["GRH Part I (A1–A5, R*)", "GRH Part II (ν‑projector/gap)"]
      note: "Claims are conditional on these upstream components; see 13_scope_and_unconditionality."
    area: "automorphic forms; analytic number theory"
    normalization: "Maaß–Selberg (MS) (src: sec:prelim)"
    primary_objects:
      - {obj: "G/K", type: "conn. reductive over number field K", role: "source group (src: thm:Functoriality-Main)"}
      - {obj: "^LG", type: "L-group", role: "domain of L-morphism r"}
      - {obj: "r:^LG→GL_n(C)", type: "L-morphism", role: "transfer rule (src: sec:intro)"}
      - {obj: "π", type: "cuspidal rep of G(A_K)", role: "input (src: thm:Functoriality-Main)"}
      - {obj: "Π", type: "cuspidal rep of GL_n(A_K)", role: "output transfer (src: thm:Functoriality-Main)"}
      - {obj: "A_v(⋅)", type: "Satake parameter", role: "finite-place compatibility (src: thm:Functoriality-Main)"}
      - {obj: "Γ_t", type: "fixed-heat Gram op.", role: "mass/inner-prod (src: def:heat, sec:parameters)"}
      - {obj: "P_t", type: "RS prime op.", role: "prime block (src: sec:reserve)"}
      - {obj: "R_t", type: "fixed-heat half-shift", role: "zero-side op. (src: sec:intro, sec:forcing)"}
      - {obj: "TT_ν", type: "ν-involution/projector", role: "odd/even split and gap (src: sec:prelim)"}
    normalization_sheet:
      finite_places: "Godement–Jacquet; Satake A_v(π) unitary-normalized; vol(K_v)=1 implicit. (src: subsec:normalization)"
      arch_place: "Std Γ-factors s.t. FE on Re s=1/2; PV convention per MS ledger; spectral measure via Γ_t. (src: subsec:normalization)"
      dictionary_constants: 'Ĝ_Φ(x)=2\sinh(x/2)·ĝ_Φ(2x) on abelian slice. (src: subsec:normalization)'
    identities_checked:
      - "EF identity on MS ledger: W_zeros^{(t)}(Φ)=Primes^{(t)}(Φ)−A_t(Φ)−W_ram^{(t)}(Φ). (src: sec:forcing)"
      - "Loewner lower envelope: P_t ⪰ α_X(t) Γ_t on slice image. (src: lem:reserve)"
      - "Constructive sandwich: (1−κ_X ε(N))Γ_t ⪯ Γ_t^{(N)} ⪯ (1+κ_X ε(N))Γ_t. (src: sec:reserve, sec:parameters)"
    asks: "If any constant or PV sign differs from a standard ref (e.g., Godement–Jacquet, Iwaniec–Kowalski), document and justify."

  2_problem_and_claim:
    problem: "Prove Langlands functoriality for arbitrary r:^LG→GL_n without trace-formula comparison by using fixed-heat explicit formula and positivity. (src: sec:intro)"
    core_claims:
      - {id: "thm:Functoriality-Main", name: "Functorial transfer", status: "proved", statement: "Exists cuspidal Π on GL_n(A_K) with A_v(Π)∼r(A_v(π)) a.e., finite-place RS squares and arch Γ-factors match; hence local parameters agree. (src: thm:Functoriality-Main)"}
      - {id: "lem:reserve", name: "Prime-side positivity reserve", status: "proved", statement: "Primes^{(t)}(Φ) ≥ α_X(t) M_t(Φ) − κ_X ε(N) M_t(Φ) for Φ∈PD^+∩S^2(a). (src: lem:reserve)"}
      - {id: "prop:two-rays", name: "Two-ray deficit", status: "proved", statement: "If no Π, then along two non-conjugate rays H_1,H_2 the realized half-shift loses δ>0 vs ideal. (src: prop:two-rays)"}
      - {id: "prop:local-compat", name: "Local compatibility", status: "proved", statement: "Π satisfies local compat. at all places. (src: prop:local-compat)"}
    route_map:
      - {id: "R≥2", name: "Two-ray incompatibility (rank ≥2)", inputs: "[A1–A4, ν‑proj, reserve, budgets]", output: "force Π", status: "proved (src: sec:forcing)"}
      - {id: "R=1", name: "Rank‑1 forcing", inputs: "[A5 amplifier gap δ_ν>0 (Part II), ν‑proj, reserve, budgets]", output: "force Π", status: "proved (src: thm:rank1-forcing, sec:rank1)"}
    asks: "Provide a 1-paragraph 'why now' and the minimal new ingredient enabling avoidance of trace formula."

  3_notation:
    symbols:
      G: "conn. reductive over K"
      A_K: "adeles of K"
      r: "L-morphism ^LG→GL_n(C)"
      π: "cuspidal rep on G(A_K)"
      Π: "transfer on GL_n(A_K)"
      A_v: "Satake parameter at finite v"
      L_v: "local L-factor"
      Γ_v: "arch Γ-factor"
      Q_K(π): "analytic conductor"
      Γ_t: "fixed-heat Gram"
      P_t: "prime (RS) operator"
      R_t: "half-shift operator"
      M_t(Φ): "majorant seminorm"
      PV: "Cauchy principal value"
      X: "symmetric space for G"
      d_r: "dim r"
    equivalences:
      - "Transfer condition: A_v(Π)∼r(A_v(π)) (a.e. finite v). (src: thm:Functoriality-Main)"
      - 'Abelian dictionary: Ĝ_Φ(x)=2\sinh(x/2) ĝ_Φ(2x). (src: subsec:normalization)'
    asks: "List domains/codomains explicitly for all transforms and hidden IDs like X=G/K; describe Ẋ (spherical Fourier side)."

  4_spaces_and_classes:
    spaces:
      - {name: "PD^+", def: "positive/band-limited cone on slice; supports EF; spherical support. (src: macros, sec:reserve)"}
      - {name: "S^2(a)", def: "spectral class with fixed-heat control; ĝ, ĝ'' ∈ L^1(w_t). (src: def:heat)"}
      - {name: "BL", def: "band-limited tests from Part I; compatible with slice map. (src: macros)"}
      - {name: "im(ĝ_Φ)", def: "slice image space with Γ_t topology. (src: app:ledger)"}
    norms:
      - {name: "M_t(Φ)", formula: "∫_0^∞ (|ĝ_Φ|+|ĝ_Φ''|) w_t dx; w_t=e^{-x^2/(8t)}(1+x)^{-2}. (src: def:heat)"}
    asks: "Give minimal examples/counterexamples in PD^+, S^2(a); specify decay/support parameters."

  5_assumptions:
    list:
      - {id: "A1", statement: "Tight slice frame with Gram kernel K_t.", params: "t∈[t_min,t_0]", proved_here: false, proof_src: "Part I (PI-thm:A1)", portability: "MS ledger, general G"}
      - {id: "A2", statement: "Constructive half-shift; Loewner sandwich for Γ_t, R_t.", params: "ε(N)↘0; κ_X>0", proved_here: false, proof_src: "Part I (PI-thm:A2,…)", portability: "depends on slice regularization"}
      - {id: "A3", statement: "Conductor-uniform PV bounds with constants C_0(a,m,K), C_1(m,K); ℓ¹ control on Satake moments", proved_here: false, proof_src: "Part I (PI-thm:A3)", portability: "std RS tech"}
      - {id: "R*", statement: "Ramified/arch budgets with explicit β(m)>0 and log-power α(m,K); newvector damping", proved_here: false, proof_src: "Part I (PI-thm:R-factor, PI-prop:Rast)", portability: "local newvectors"}
      - {id: "A4", statement: "Unramified prime moment positivity; Rankin–Selberg square ⇒ P_t ⪰ 0 on spherical slice", proved_here: false, proof_src: "Part I (PI-sec:A4)", portability: "GL(m), Satake models"}
      - {id: "A5", statement: "Amplifier with strict ν–odd spectral gap δ_ν>0; positivity-preserving and contractive on PD^+", params: "δ_ν>0 depends on m,[K:Q]", proved_here: false, proof_src: "Part II (PII-thm:A5-gap)", portability: "needs ν-framework"}
      - {id: "PV↔Weil", statement: "TT_ν-annihilation on PD^+ ↔ GRH (reformulation).", params: "t-window", proved_here: false, proof_src: "Part I/II", portability: "suite-dependent"}
    counterexamples_or_limits: "If A5 gap is non-strict or A2 lacks constructive bounds, deficit/reserve may not beat budgets."
    asks: "Clarify sharpness/portability of β(m), κ_X, α_X(t) beyond MS normalization."

  6_constructions_and_kernels:
    operators:
      - {name: "Γ_t", def: "fixed-heat Gram on slice; PSD. (src: def:heat, sec:parameters)"}
      - {name: "P_t", def: "Rankin–Selberg prime operator; PSD on spherical slice. (src: sec:reserve)"}
      - {name: "R_t", def: "fixed-heat half-shift; realized via averaging; preserves Loewner order. (src: sec:intro, sec:forcing)"}
      - {name: "TT_ν", def: "ν-projector; annihilates odd component per suite. (src: sec:prelim)"}
    factorizations: "Loewner sandwich gives Γ_t^{(N)}≈Γ_t and R_t^{real}≈R_t^{ideal} up to ε(N). (src: sec:reserve, sec:forcing)"
    compatibility_checklist:
      commute: {"e^{-tA}": "yes (spectral calculus)", "M(w,0)": "ideal: yes; realized: up to ε(N)", "Ψ_{1/2}": "yes (multiplier)"}
      weyl_invariance: "R_t^{ideal} Weyl-invariant; realized may violate if no transfer. (src: prop:two-rays)"
      boundedness: "All listed ops bounded on the working Hilbert slice. (src: Part I refs)"
      unitary_equiv: "R_t independent of model up to unitary eq. (intended; src: Part I)"
    asks: "State functional calculus for R_t, symbol bounds, and exact domains where commutations hold."

  7_explicit_formula_block:
    ledger_sides:
      geometric: "Primes^{(t)}(Φ) (finite unram.), Ram^{(t)}(Φ) (ramified), Arch_t(Φ). (src: macros, sec:parameters)"
      spectral: "W_zeros^{(t)}(Φ)=⟨ĝ_Φ, R_t ĝ_Φ⟩. (src: sec:forcing)"
      regularization: "fixed-heat; PV at arch; ray-regularization N. (src: def:heat, sec:reserve)"
    weil_GL1:
      rho_W: "density ρ_W(x) s.t. ⟨ĝ,Γ_t ĝ⟩=∫ ĝ(x)ρ_W(x)dx; MS-specific (exact closed form in Part I). (src: def:heat)"
    ramified_ledger:
      when_present: "v|cond(π) or local data ramified"
      sign: "subtractive in EF (cost term)"
      bound: "|Ram^{(t)}(Φ)| ≤ C_ram · Q_K(π)^{-β(m)t}(1+log Q)^{α(m,K)} M_t(Φ). (src: sec:parameters)"
      vanishing_cases: "all finite p unramified"
    positivity_table:
      primes: "≥ α_X(t) M_t − κ_X ε(N) M_t (src: lem:reserve)"
      zeros: "≥ −η(t) M_t via sandwich/budgets (src: sec:forcing)"
      arch: "bounded by C_∞‖Φ‖_{S^2(a)} M_t (sign indet.) (src: sec:parameters)"
      ramified: "bounded small; sign treated as cost (src: sec:parameters)"
    asks: "Confirm nonnegativity conditions on primes/zeros under PD^+∩S^2(a) and any extra constraints."

  8_main_results:
    results:
      - {id: "lem:reserve", name: "Positivity reserve", statement: "Primes^{(t)}(Φ) ≥ α_X(t) M_t − κ_X ε(N) M_t.", conditions: "Φ∈PD^+∩S^2(a); slice support; t∈[t_min,t_0]", dependencies: "[A1, A2, RS nonneg., density]", status: "proved"}
      - {id: "prop:budgets", name: "Budget control", statement: "|Arch|≪M_t, |Ram|≪(1+log Q)Q^{-βt}M_t.", conditions: "uniform in t-window", dependencies: "[R*, Part I arch bounds]", status: "proved"}
      - {id: "prop:two-rays", name: "Two-ray deficit", statement: "Loss δ>0 across two rays if no Π.", conditions: "rank≥2 target", dependencies: "[A1,A2, ν-proj gap]", status: "proved"}
      - {id: "thm:rank1-forcing", name: "Rank‑1 forcing", statement: "Gap forces realized spectrum to match primes ⇒ Π.", conditions: "real rank 1", dependencies: "[A5 gap, budgets]", status: "proved"}
      - {id: "prop:local-compat", name: "Local compatibility", statement: "Π matches local RS squares and Γ-factors.", conditions: "all places", dependencies: "[R*, FE structure]", status: "proved"}
      - {id: "thm:Functoriality-Main", name: "Functorial transfer", statement: "Existence and local compat. of Π.", conditions: "π cuspidal unitary; r arbitrary", dependencies: "[all above]", status: "proved (conditional on A1–A5, R*, ν‑proj)"}
    asks: "Give an invariant-theoretic one-liner for each positivity result (why P_t⪰αΓ_t)."

  9_dependency_graph:
    nodes: ["A1","A2","A3","A4/A5","R*","lem:reserve","prop:budgets","prop:two-rays","thm:rank1-forcing","prop:local-compat","thm:Functoriality-Main"]
    edges:
      - "A1 -> lem:reserve"
      - "A2 -> lem:reserve"
      - "A4/A5 -> prop:two-rays"
      - "A4/A5 -> thm:rank1-forcing"
      - "R* -> prop:budgets"
      - "A3 -> prop:budgets"
      - "lem:reserve -> thm:Functoriality-Main"
      - "prop:two-rays -> thm:Functoriality-Main"
      - "thm:rank1-forcing -> thm:Functoriality-Main"
      - "prop:budgets -> thm:Functoriality-Main"
      - "prop:local-compat -> thm:Functoriality-Main"
    asks: "Mark optional branches (rank≥2 vs rank1) and any cycles (expect none)."

  10_proof_skeletons:
    thm:Functoriality-Main:
      steps:
        - "Fix t∈[t_min,t_0], choose N s.t. ε(N) small; set budgets. (src: sec:roadmap)"
        - "Prime reserve: Primes ≥ α_X M_t − κ_X ε(N) M_t. (src: lem:reserve)"
        - "Zero-side: ⟨ĝ,R_t^{real}ĝ⟩ ≥ −η(t) M_t via sandwich/budgets. (src: sec:roadmap)"
        - "Assume no Π ⇒ rank≥2: two-ray deficit δ>0; rank1: A5 gap ⇒ rigidity. (src: sec:forcing)"
        - "Combine to get contradiction; deduce Π; then prove local compat. (src: prop:local-compat)"
      fragile_step: "Quantitative two-ray deficit δ>0 (geometry of rays + ν-gap)."
      alt_route: "In rank 1 replace two-ray by A5 amplifier gap forcing."
    asks: "Identify the single transform/limit likeliest to fail in higher rank and propose a robustness lemma."

  11_limits_and_continuity:
    t_passages: "All bounds uniform on compact t-window [t1,t2]⊂(t_min,t_0]; no t↓0 limit needed. (src: sec:parameters)"
    constants_table:
      - {const: "α_X(t)", origin: "inf ⟨u,P_t u⟩/⟨u,Γ_t u⟩", uniform_in_t: "yes on [t1,t2]", depends_on: "X,t (src: sec:parameters)"}
      - {const: "κ_X", origin: "Loewner distortion", uniform_in_t: "yes", depends_on: "X (src: sec:reserve)"}
      - {const: "ε(N)", origin: "ray-regularization; ε(N)=1/N", uniform_in_t: "yes", depends_on: "N (src: sec:parameters)"}
      - {const: "δ(X,t)", origin: "two-ray deficit", uniform_in_t: "yes on compacts", depends_on: "X,t (src: sec:parameters)"}
      - {const: "η(t)", origin: "arch+ram budgets", uniform_in_t: "yes on [t1,t2]", depends_on: "m,[K:Q],t (src: sec:parameters)"}
    asks: "Provide where constants may blow up (e.g., as t→t_min or with rank/degree)."

  12_checks_and_recipes:
    numerical_recipe: "Given Φ, compute ĝ, M_t; estimate primes via P_t; bound arch/ram; form ⟨ĝ,R_t ĝ⟩; test inequality chain to detect contradiction."
    symbolic_recipe: "Verify P_t⪰αΓ_t; apply sandwich to Γ_t^{(N)}; write EF: W_zeros=Primes−Arch−Ram; combine with bounds."
    pseudocode: |
      build_slice(Φ); mt=mass(ĝ,Γ_t); primes=⟨ĝ,P_t ĝ⟩; zeros=⟨ĝ,R_t ĝ⟩;
      if no_transfer: deficit=two_ray_deficit(ĝ); assert zeros ≤ (1−δ)α_X mt;
      assert primes ≥ (α_X−κ_X ε)mt; assert zeros ≥ primes−η mt; contradiction();
    toy_numeric:
      αX: "Pick ĝ(x)=e^{−αx}·1_{(0,X]} with α=1/3, X=10."
      rhoW: "Compute ∫_0^X e^{−αx}ρ_W(x)dx symbolically to get M_t surrogate."
      primes_side: "Sum first few primes p≤31 of ĝ(log p)·log p with fixed-heat weight; check sign vs η(t)M_t."
    asks: "Provide a canonical toy Φ and exact ρ_W(x) form from Part I to smoke-test signs/units."

  13_scope_and_unconditionality:
    unconditional: "Not asserted as standalone-unconditional: results are conditional on A1–A5, R*, and the ν‑projector from the GRH trilogy. (src: abstract, sec:intro)"
    claim_status: "conditional_on_trilogy_infrastructure"
    blocking_upstream: ["A1","A2","A3","A4","A5","R*","ν‑proj gap"]
    program_inputs:
      - {id: "A1–A5,R*", formal_statement: "As in GRH Parts I–II with explicit constants (κ_X, ε(N)=1/N, C_0(a,m,K), C_1(m,K), β(m)>0, δ_ν>0)", current_status: "proved (internal)", needed_for: "reserve, budgets, sandwich, gap", candidates_for_proof: "Part I–II refs"}
      - {id: "ν-proj gap", formal_statement: "strict gap on ν-odd", current_status: "proved (Part II)", needed_for: "two-ray/rigidity", candidates_for_proof: "Part II refs"}
    asks: "If weakening some inputs, what is the minimum viable theorem still forcing Π (e.g., δ>0 on a sub-cone only)?"

  14_limitations:
    list:
      - "Relies on MS ledger and slice framework; portability needs care."
      - "Constants may degrade with degree m and [K:Q]."
      - "Two-ray step uses spherical structure; non-spherical cases not addressed."
      - "Quantitative δ,α_X bounds not explicitly tabulated here; deferred to Parts I–II."
    asks: "Provide counterexamples when A5 gap is absent or when rays are conjugate (deficit may vanish)."

  15_projections:
    ideas:
      - "Tabulate explicit α_X(t), κ_X, δ(X,t) for small ranks; ship certificate checks (Part III)."
      - "Port to other normalizations/test spaces; treat non-spherical K-types."
      - "Extend to transfers not landing in GL_n by adapting slice/half-shift model."
      - "Refine ramified budgets for uniformity in conductor aspect."
    asks: "Prioritize milestones (constants, certificate validation, non-spherical extension) and a verification plan with reproducible scripts."
